<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script>
       function checks(){
           //값 불러오기
           //아이디 있는 input태그를 선택하기 
           var getId = document.getElementById("id");
           var getPw = document.getElementById("password");
           var getPwCheck = document.getElementById("password_check");
           var getMail = document.getElementById("mail");
           var getName = document.getElementById("name");
           var getIdNum = document.getElementById("id_num");
           var getIdNumBack = document.getElementById("id_num_back");
           var getYear = document.getElementById("year");
           var getMonth = document.getElementById("month");
           var getDay = document.getElementById("day");
           var getHobby =  document.getElementsByName("hobby");
           var getIntro = document.getElementById("intro");

            //value값 가지고 오기 
            //getId변수안는 아이디의 위치값이 있다 
            //getId.value하면 해당 위치에 입력한 값을 가져온다
            var id = getId.value;
            var pw = getPw.value;
            var pwCheck = getPwCheck.value;
            var mail = getMail.value;
            var name = getName.value;
            var idNum = getIdNum.value;
            var idNumBack = getIdNumBack.value;
            var idJumin = idNum + "-" + idNumBack;
            var year = getYear.value;
            var month = getMonth.value;
            var day = getDay.value;
            var hobby = getHobby.value;
            var intro = getIntro.value;

            //데이터의 유효성 검사 - 정규표현식
            //1. 4~12자 영문 대소문자와 숫자로만 입력 정규식 표현
            var regExp = /^[a-zA-Z0-9]{4,12}$/ ;
            //2. 한글만 2글자 이상 예) 이름
            var regName = /^[가-힣]{2,}$/ ;
            //3. 이메일 
            var regMail = /[a-zA-Z0-9]{2,}@[a-zA-Z0-9]{2,}.[a-zA-Z0-9]{2,4}/ ;
            //4. 주민등록번호 
            var regJumin = /\d{2}([0]\d|[1][0-2])([0][1-9]|[1-2]\d|[3][0-1])[-]*[1-4]\d{6}/;
            //5. 숫자4  생일의 년도 구하는 유효성 표현
            var regYear = /^[0-9]{4}$/ 

            //입력 받은 값과 데이터 유효성 검사 자료 비교하기 alert( regExp.test(id) );   ! 부정 
           if( !regExp.test(id) ) {
                //정규표현식에 틀린 내용 
                alert("아이디의 형식 틀립니다. 다시 입력하세요");
                getId.value = "";
                getId.focus();
                return false;
            }else if( !regExp.test(pw) ){
                alert("비밀번호의 형식 틀립니다. 다시 입력하세요");
                getPw.value = "";
                getPw.focus();
                return false;
            }else if( !( pwCheck.slice(0, pwCheck.length) == pw.slice(0, pw.length) ) ){
                alert("비밀번호와 비밀번호 확인 틀립니다");
                getPwCheck.value = "";
                getPwCheck.focus();
                return false;
            } else if( id.slice(0, id.length) == pw.slice(0, pw.length) ) {
                //id랑 비밀번호가 동일하면 안됨 
                alert("아이디와 동일하게 비밀번호 쓰시면 안되요 다시 하세요");
                getPw.value = "";
                getPwCheck.value = "";
                getPw.focus();
                return false;
            } else if( !regMail.test(mail) ) {
                //이메일 유효성검사
                alert("이메일 형식 틀립니다.");
                getMail.value = "";
                getMail.focus();
                return false;
            } else if( !regName.test(name) ) {
                //이름 유효성 검사 
                alert("이름은 한글로만 해주세요");
                getName.value = "";
                getName.focus();
                return false;
            } else if(  check_jumin()  ){
              //생일의 년도가 숫자 4자리만 되게 유효성 검사 
              
                return false;
            
           }else if(   document.data.hobby[0].checked == false  &&  document.data.hobby[1].checked == false &&
                       document.data.hobby[2].checked == false && document.data.hobby[3].checked==false &&
                       document.data.hobby[4].checked == false   ){
                 //관심분야를 한개라도 체크가 안되면 체크부탁해요 
                 alert("관심분야를 한개라도 체크해 주세요");
                 return false;
            }  else if( getIntro.value == "" ){
                alert("자기소개를 한글자라도 써주세요" );
                return false;
            }
       } //end checks();

       //주민번호 체크하는 함수 정의    
       function check_juminOk() {
            var jumin = document.getElementById("id_num").value  + document.getElementById("id_num_back").value;//"8512031035241"
            //주민번호 앞자리의 정규표현식      
           var regJuminbunho = /^\d{6}[1234]\d{6}$/;
           if( regJuminbunho.test( jumin )){
               return true;
           }else {
               return false;
           }
       }

       function check_jumin(){
           if( check_juminOk() ) {
               console.log("여기 찍어 보자!!");
               alert("올바른 주민번호입니다");

               var year = document.getElementById("year"); //생년월일 년도 위치
               var num1 = document.getElementById("id_num"); //주민번호에서 앞부분 851203
               var num2 = num1.value; // 851203  050810-4052315
               console.log("여기 찍어 보자!!" + num2);
               var num3 = num2.slice(0, 2); //85
               console.log("여기 찍어 보자!!" + num3);
               var num4 = num2.slice(2, 4); //12
               console.log("여기 찍어 보자!!" + num4);
               var num5 = num2.slice(4, 6); //03
               console.log("여기 찍어 보자!!" + num5);

               var inb = document.getElementById("id_num_back").value; //1030512 4052315
               console.log("여기 찍어 보자!!" + inb);

               var gender =Number( inb.slice(0,1) ); //"1"  ---> 1 
               if( gender <= 2) {
                   year = "19" + num3;
               } else {
                   year = "20" + num3; 
               } 

               document.getElementById("year").value = year;
               document.frm.month.value = num4;   
               document.frm.day.value = num5;  
               return true;
           }else {
               alert("주민번호가 틀렸습니다");
               return false;
           }
       }
       
       
    </script>
</head>
<body>

    <form action="server.html" name="data" method="post" onsubmit="return checks()">

        <!--밑에 submit 누르면 메일로 보내짐-->

    <table border="1" bordercolor="grey" align="center">

        <tbody>

        <tr>

            <td colspan="2" bgcolor="lightblue" align="center">회원 기본 정보</td>

        </tr>

        <tr>

            <td bgcolor="lightgrey" align="center">아이디</td>

            <td><input size="15" type="text" id="id"> 4~12자의 영문 대소문자와 숫자로만 입력</td>

        </tr>

        <tr>

            <td bgcolor="lightgrey" align="center">비밀번호</td>

            <td><input size="15" type="password" id="password"> 4~12자의 영문 대소문자와 숫자로만 입력</td>

        </tr>

        <tr>

            <td bgcolor="lightgrey" align="center">비밀번호 확인</td>

            <td><input size="15" type="password" id="password_check"></td>

        </tr>

        <tr>

            <td bgcolor="lightgrey" align="center">메일 주소</td>

            <td><input type="text" id="mail"> 예) id@domain.com</td>

        </tr>

        <tr>

            <td bgcolor="lightgrey" align="center">이름</td>

            <td><input type="text" id="name"></td>

        </tr>

        <tr>

            <td colspan="2" bgcolor="lightblue" align="center"> 개인 신상 정보</td>

        </tr>

        <tr>

            <td bgcolor="lightgrey" align="center">주민등록번호</td>

            <td>

                <input size="7" type="text" id="id_num">

                - <input size="7" type="password" id="id_num_back">
             
                <input type="button" onclick="check_jumin()" value="확인">

            </td>

        </tr>

        <tr>

            <td bgcolor="lightgrey" align="center">생일</td>

            <td>

                <input size="5" type="text" id="year">년

                <select id="month">

                        <option value="1">1</option>

                        <option value="2">2</option>

                        <option value="3">3</option>

                        <option value="4">4</option>

                        <option value="5">5</option>

                        <option value="6">6</option>

                        <option value="7">7</option>

                        <option value="8">8</option>

                        <option value="9">9</option>

                        <option value="10">10</option>

                        <option value="11">11</option>

                        <option value="12">12</option>

                </select>

                월

                <select id="day">

                        <option value="1">1</option>

                        <option value="2">2</option>

                        <option value="3">3</option>

                        <option value="4">4</option>

                        <option value="5">5</option>

                        <option value="6">6</option>

                        <option value="7">7</option>

                        <option value="8">8</option>

                        <option value="9">9</option>

                        <option value="10">10</option>

                        <option value="11">11</option>

                        <option value="12">12</option>

                        <option value="13">13</option>

                        <option value="14">14</option>

                        <option value="15">15</option>

                        <option value="16">16</option>

                        <option value="17">17</option>

                        <option value="18">18</option>

                        <option value="19">19</option>

                        <option value="20">20</option>

                        <option value="21">21</option>

                        <option value="22">22</option>

                        <option value="23">23</option>

                        <option value="24">24</option>

                        <option value="25">25</option>

                        <option value="26">26</option>

                        <option value="27">27</option>

                        <option value="28">28</option>

                        <option value="29">29</option>

                        <option value="30">30</option>

                        <option value="31">31</option>

                </select>

                일

            </td>

        </tr>

        <tr>

            <td bgcolor="lightgrey" align="center">관심분야</td>

            <td>

                <input type="checkbox" name="hobby" value="computer">컴퓨터

                <input type="checkbox" name="hobby" value="internet">인터넷

                <input type="checkbox" name="hobby" value="travel">여행

                <input type="checkbox" name="hobby" value="movie">영화감상

                <input type="checkbox" name="hobby" value="music">음악감상

            </td>

        </tr>

        <tr>

            <td bgcolor="lightgrey" align="center">자기소개</td>

            <td><textarea cols="50" style="margin: 0px; height: 300px; width:480px" id="intro"></textarea>

                <!--크기 조정 가능-->

            </td>

        </tr>

    </tbody>

    </table>

        <p align="center">

            <input type="submit" value="회원 가입">

            <!--누르면 메일이 보내짐-->

            <input type="reset" value="다시 입력">

            <!--누르면 초기화-->

        </p>

</form>

</body>

</html>